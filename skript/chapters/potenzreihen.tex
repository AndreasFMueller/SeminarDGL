%
% potenzreihen.tex -- LÃ¶sung von Differentialgleichungen mit Potenzreihen
%
% (c) 2015 Prof Dr Andreas Mueller, Hochschule Rapperswil
%
\chapter{Potenzreihen-Methode\label{chapter:potenzreihen}}
\rhead{}
\lhead{Potenzreihen-Methode}
Die meisten Differentialgleichungen k"onnen nicht in geschlossener
Form gel"ost werden.
Viele davon sind aber von generischer Bedeutung, sie treten
in verschiedenen Anwendungen immer wieder auf, und verdienen daher
genauer studiert zu werden.
In solchen F"allen kann man die L"osungsfunktionen einfach also
neue interessante Funktionen definieren, ihnen einen Namen geben
und sie verwenden wie zum Beispiel die trigonometrischen Funktionen.
Um sie aber auch berechnen zu k"onnen, braucht man irgend eine 
effiziente Darstellung.
Potenzreihen haben sich daf"ur als besonders geeignet herausgestellt.

In diesem Kapitel wird gezeigt, wie Differentialgleichungen mit Potenzreihen
gel"ost werden k"onnen.
Es zeigt, dass die trigonometrischen Funktionen als Resultat
dieser L"osungsmethode gefunden werden, und es verallgemeinert die
Methode soweit, dass auch kompliziertere Funktionen wie die
Bessel-Funktionen damit verstanden werden k"onnen.

\section{Analytische L"osungen
\label{section:potenzreihen:analytisch}}
\rhead{Analytische L"osungen}
Wir setzen daher die L"osung in Form einer Potenzreihe als
\begin{equation}
y(x)
=
\sum_{k=0}^\infty a_kx^k
\label{potenzreihen:ansatz}
\end{equation}
an, und versuchen die Koeffizienten aus der Differentialgleichung mit
Hilfe eines Koeffizientenvergleichs zu bestimmen.
Die Ableitungen von $y(x)$ sind
\begin{equation}
\begin{aligned}
y'(x)
&=
\sum_{k=1}^\infty a_kkx^{k-1}
=
\sum_{k=0}^\infty a_{k+1}(k+1)x^k
\\
y''(x)
&=
\sum_{k=2}^\infty a_kk(k-1)x^{k-2}
=
\sum_{k=0}^\infty a_{k+2}(k+1)(k+2)x^k 
\\
&\vdots
\end{aligned}
\label{potenzreihen:ableitungen}
\end{equation}

\section{Trigonometrische Funktionen
\label{section:potenzreihen:trigo}}
\rhead{Trigonometrische Funktionen}
Die trigonometrischen Funktionen $\sin x$ und $\cos x$ sind L"osungen
der Schwingungsdifferentialgleichung
\begin{equation}
\begin{aligned}
y''&=-y
&&\text{oder}&
y''+y&=0.
\end{aligned}
\label{potenzreihen:schwingungsdgl}
\end{equation}
Die Potenzreihen-Methode erlaubt uns, direkt Potenzreihen f"ur die
L"osungen von (\ref{potenzreihen:schwingungsdgl}) zu finden.
Wir setzen den Ansatz (\ref{potenzreihen:ansatz}) und die zweite Ableitung
(\ref{potenzreihen:ableitungen}) in die Schwingungsdifferentialgleichung
(\ref{potenzreihen:schwingungsdgl}) ein und erhalten
\begin{equation}
\sum_{k=0}^\infty a_{k+2}(k+1)(k+2)x^k 
+
\sum_{k=0}^\infty a_kx^k
=0.
\end{equation}
Koeffizientenvergleich ergibt die Rekursionsformel
\begin{equation}
\begin{aligned}
\sum_{k=0}^\infty \bigl(a_{k+2}(k+1)(k+2) + a_k\bigr)x^k
&=0
&&\Rightarrow&
a_{k+2}=-a_k\frac1{(k+1)(k+2)}.
\end{aligned}
\end{equation}
Damit die Koeffizienten eindeutig bestimmt sind, m"ussen $a_0$
und $a_1$ festgelegt werden, also der Funktionswert  und die erste
Ableitung bei $x=0$.
Wir finden
\begin{equation*}
\begin{aligned}
a_0&=1,&a_1&=0
&&\Rightarrow&
a_{2k}&=\frac{(-1)^k}{(2k)!},&a_{2k+1}&=0
&&\Rightarrow&
y(x)&=1-\frac{x^2}{2!}+\frac{x^4}{4!}-\dots=\cos x
\\
a_0&=0,&a_1&=1
&&\Rightarrow&
a_{2k}&=0,&a_{2k+1}&=\frac{(-1)^k}{(2k+1)!}
&&\Rightarrow&
y(x)&=x-\frac{x^3}{3!}+\frac{x^5}{5!}-\dots=\sin x,
\end{aligned}
\end{equation*}
die bekannten Taylor-Reihenentwicklungen der trigonometrischen Funktionen.

\section{Verallgemeinerte Potenzreihen
\label{section:potenzreihen:verallgemeinert}}
\rhead{Verallgemeinerte Potenzreihen}
Viele Differentialgleichungen in der Anwendungen sind von der Form
\begin{equation}
x^2y''+p(x)xy'+q(x)y=0,
\label{potenzreihen:verallgemeinert-dgl}
\end{equation}
wobei $p(x)$ und $q(x)$ beliebige Funktionen von $x$ sind.
Das h"aufige Auftreten der Kombinationen $x^2y''$ und $xy'$ in Anwendungen
wird durch ein Dimensionsargument verst"andlich.
Schreiben wir $[u]$ f"ur die Masseinheit einer Gr"osse, dann gilt
\begin{equation*}
\begin{aligned}
\biggl[\frac{dy}{dx}\biggr]
&=
\frac{[y]}{[x]}
&
&\Rightarrow&
[xy']&=[y]\\
\biggl[\frac{d^2y}{dx^2}\biggr]
&=
\frac{[y]}{[x]^2}
&
&\Rightarrow&
[x^2y'']&=[y]
\end{aligned}
\end{equation*}
Wenn zwischen den Termen $x^2y''$, $xy'$ und $y$ irgend ein
gesetzm"assiger Zusammenhang bestehen soll, dann ist die wohl
einfachste Form davon eine lineare Beziehung mit dimensionslosen
Koeffizienten wie in~(\ref{potenzreihen:verallgemeinert-dgl}).

Die Differentialgleichung~(\ref{potenzreihen:verallgemeinert-dgl})
liefert f"ur den Punkt $x=0$ keinen Wert von $y''$.
Eine L"osungsfunktion $y(x)$, die die Differentialgleichung f"ur
$x\ne 0$ erf"ullt, erf"ullt sie f"ur alle $x$, wenn $y(0)=0$ oder
wenn $q(0)=0$ ist. 
Insbesondere haben die Ableitungen an der Stelle $x=0$ keinen
Einfluss darauf, ob die Differentialgleichung erf"ullt ist.
Man spricht auch von einer ausserwesentlichen Singularit"at an
der Stelle $x=0$.
Wir k"onnen allerdings nicht mehr annehmen, dass die L"osung als
Potenzreihe in $x$ geschrieben werden kann, denn eine solche
L"osung w"urde beliebige Ableitungen im Punkt $x=0$ haben, was 
die Differentialgleichung nicht garantieren kann.

\subsection{Verallgemeinerter Ansatz und Indexgleichung}
\label{subsection:potenzreihen:indexgleichung}
Setzt man $y(x)$ als Potenzreihe der Form~(\ref{potenzreihen:ansatz}) an,
dann beginnt die Potenzreihe von $x^2y''$ mit dem Term $a_2x^2$,
und $xy'$ beginnt mit $a_1x$.
Daraus folgt, dass nur der Term mit $y$ der
Differentialgleichung~(\ref{potenzreihen:verallgemeinert-dgl})
einen konstanten Term hat, also $a_0=0$.
Teilt man die Differentialgleichung durch $x$ und l"asst $x$ gegen $0$
streben, bekommt man
\begin{align*}
0&=
\lim_{x\to 0}\biggl(
\underbrace{xy''(x)}_{\to 0}+p(x)y'(x)+q(x)\underbrace{\frac{y(x)}{x}}_{\to y'(0)}\biggr)
\\
&=
p(0)y'(0)+q(0)y'(0)
=(p(0)+q(0))a_1
\end{align*}
so dass auch $a_1=0$ sein muss.
Damit kann man auch noch durch $x^2$ teilen und bekommt
\begin{align*}
0&=
\lim_{x\to 0}\biggl(
y''(x)+p(x)\underbrace{\frac{y'(x)}{x}}_{\to y''(0)}+q(x)\frac{y(x)}{x^2}
\biggr)
\\
&=y''(0)+p(0)y''(0)+q(0)a_2
=2a_2+p(0)2a_2+q(0)a_2
=(2+2p(0)+q(0))a_2
\end{align*}
also ist auch $a_2=0$, das Argument l"asst sich offenbar fortsetzen, 
im Allgemeinen wird $a_k=0\;\forall k$ oder $y(x)=0$.
Der einfache Potenzreihenansatz~(\ref{potenzreihen:ansatz}) f"uhrt
daher nicht zum Ziel.

Wir suchen jetzt eine L"osung der
Differentialgleichung~(\ref{potenzreihen:verallgemeinert-dgl})
in Form einer verallgemeinerten Potenzreihe der Form
\begin{equation}
y(x)=x^\varrho\sum_{k=0}^\infty a_kx^k.
\label{potenzreihen:verallgemeinert}
\end{equation}
\index{Potenzreihe!verallgemeinerte}%
Ausser den Koeffizienten $a_k,\;k\ge 0$ ist auch der Exponent
$\varrho$ zu bestimmen.
Das Problem ist so noch nicht eindeutig gestellt, denn es gilt zum Beispiel
\[
x^{-2}\bigl(x^2 + x^3 + x^4 + \dots\bigr)
=
x^{0}\bigl(1+x + x^2 + \dots\bigr),
\]
die gleiche Funktion wurde hier einmal mit $\varrho=-2$ und einmal
mit $\varrho=0$ geschrieben.
Um diese Zweideutigkeit zu vermeiden,
verlangen wir daher zus"atzlich, dass $a_0\ne 0$.

Aus der allgemeinen Theorie der linearen Differentialgleichungen
ist bekannt, dass die Gleichung (\ref{potenzreihen:verallgemeinert-dgl})
zwei linear unabh"angige L"osungsfunktionen haben wird,
welche im Allgemeinen verschiedene $\varrho$ verwenden werden.
Da jede L"osung sich als Linearkombination dieser zwei L"osungen schreiben
l"asst, k"onnen wir f"ur die Basisl"osungen zus"atzlich $a_0=1$ fordern.

Wir k"onnen $y(x)$ und seine Ableitungen auch als
\begin{equation}
\left.
\begin{aligned}
y(x)
&=
\sum_{k=0}^\infty a_kx^{\varrho+k}
\\
y'(x)
&=
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k-1}
\\
y''(x)
&=
\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k-2}
\end{aligned}
\right\}
\label{potenzreihen:verallgemeinert-ableitungen}
\end{equation}
schreiben, und vermeiden so eine explodierende Zahl von Termen, die
die Produktregel aus (\ref{potenzreihen:verallgemeinert})
hervorbringen w"urde.
Wir setzen (\ref{potenzreihen:verallgemeinert-ableitungen})
in die Differentialgleichung ein und erhalten
\begin{equation}
\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k}
+p(x)
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k}
+q(x)
\sum_{k=0}^\infty a_kx^{\varrho+k}
=0
\label{potenzreihen:verallgemeinert-reihen}
\end{equation}
Die Koeffizienten $a_k$ sollen mit Hilfe eines Koeffizientenvergleichs
bestimmt werden.
Wie in fr"uheren Beispielen kann man nicht erwarten, dass die $a_k$
durch die Differentialgleichung alleine eindeutig bestimmt sind.
Vielmehr ist davon auszugehen, dass die ersten zwei Koeffizienten
als Parameter eingehen, und erst durch die Anfangs- oder Randbedingungen
festgelegt werden k"onnen.

Offenbar m"ussen wir jetzt zus"atzliche Annahmen "uber die
Funktionen $p(x)$ und $q(x)$ machen.
Wir nehmen an, dass sich beide als Potenzreihen schreiben lassen,
wir setzen
\begin{equation*}
\begin{aligned}
p(x)&=\sum_{k=0}^\infty p_kx^k&&\text{und}
&
q(x)&=\sum_{k=0}^\infty q_kx^k.
\end{aligned}
\end{equation*}
Einsetzen in die Gleichungen~(\ref{potenzreihen:verallgemeinert-reihen})
ergibt
\begin{equation*}
\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k}
+\sum_{s=0}^\infty
\sum_{k=0}^\infty p_s(\varrho+k)a_kx^{\varrho+k+s}
+
\sum_{s=0}^\infty
\sum_{k=0}^\infty q_sa_kx^{\varrho+k+s}
=0.
\end{equation*}
Der kleinste m"ogliche Exponent von $x$ ist $\varrho$, f"ur $k=0$ und $s=0$.
Koeffizientenvergleich in diesem Fall liefert
\begin{equation}
\varrho(\varrho-1)+p_0\varrho +q_0=0,
\label{potenzreihen:indexgleichung}
\end{equation}
wobei wir $a_0=1$ verwendet haben.
Die quadratische Gleichung (\ref{potenzreihen:indexgleichung}) heisst auch die
{\em Indexgleichung}.
\index{Indexgleichung}
Sie hat im allgemeinen zwei verschiedenen L"osungen f"ur die beiden
linear unabh"angigen L"osungen der Differentialgleichungen.

\begin{beispiel}
Als Beispiel nehmen wir an, dass $p(x)=p_0$ und $q(x)=q_0$ konstant sind.
Dann verschwinden die Summen "uber $s$ und die Gleichungen f"ur den
Koeffizientenvergleich besagen nur noch:
\begin{equation}
\begin{aligned}
(\varrho + k)(\varrho+k-1)a_k+p_0(\varrho + k)a_k+q_0a_k&=0
&&\Rightarrow&
((\varrho + k)(\varrho+k-1)+p_0(\varrho + k)+q_0)a_k&=0
\end{aligned}
\end{equation}
auch dies ist eine quadratische Gleichung f"ur $\varrho$, sie wird
aber auch erf"ullt f"ur $a_k=0$ mit $k>0$.
Multiplizieren wir aus, erhalten wir
\[
(\varrho(\varrho - 1) + k\varrho+k(\varrho-1)+k^2+p_0\varrho + p_0k+q_0)a_k=0
\]
Setzen wir die Indexgleichung ein, erhalten wir
\[
(k+(2\varrho-1)+p_0)ka_k=0.
\]
Der Klammerausdruck ist quadratisch in $k$, er verschwindet nur f"ur
die Werte $k=0$ und $k=-p_0-(2\varrho-1)$, es kann also h"ochstens noch
ein weiterer Koeffizient $a_k$ von $0$ verschieden sein, und zwar genau
dann, wenn $-p_0-(2\varrho-1)$ ganzzahlig ist.
\end{beispiel}

\subsection{Doppelte Nullstellen\label{potenzreihen:doppeltens}}
Wenn die Indexgleichung~(\ref{potenzreihen:indexgleichung}) nur eine 
Nullstelle hat, dann kann das eben skizzierte Verfahren auch nur eine
Potenzreihe liefern, obwohl wir bei einer Differentialgleichung
zweiter Ordnung zwei linear unabh"angige L"osungen erwarten.
Es muss daher noch eine weitere L"osung geben, allerdings kann diese
nicht die Form einer verallgemeinerten Potenzreihe haben, sonst h"atte
das Verfahren diese gefunden.

\subsection{Bessel-Gleichung}
Die Besselsche Differentialgleichung
\begin{equation}
x^2y''+xy'+(x^2-n^2)y=0
\label{potenzreihen:verallgemeinert-bessel}
\end{equation}
ist ein Beispiel einer Differentialgleichung der
Form~(\ref{potenzreihen:verallgemeinert-dgl}) mit
$p(x)=1$ und $q(x)=x^2-n^2$.
Die Indexgleichung~(\ref{potenzreihen:indexgleichung}) wird in diesem Fall zu
\begin{equation}
\begin{aligned}
\varrho(\varrho - 1) + \varrho -n^2&=0
&&\Rightarrow&
\varrho^2-n^2&=0
&&\Rightarrow&
\varrho&=\pm n.
\end{aligned}
\label{potenzreihen:bessel-indexgleichung}
\end{equation}
Die Besselsche Differentialgleichung wird also zwei linear
unabh"angige L"osungen
$J_n(x)$ und $J_{-n}(x)$ haben, die in der Form
\[
J_{\pm n}(x)=x^{\pm n}\sum_{k=0}^\infty a_kx^k,\qquad a_0=1
\]
geschrieben werden k"onnen.
Die Funktionen $J_n(x)$ heissen {\em Bessel-Funktionen (erster Art)}.
\index{Bessel-Funktionen erster Art}
\index{Bessel-Funktionen}

Im Fallle $n=0$ hat die
Indexgleichung~(\ref{potenzreihen:bessel-indexgleichung}) eine doppelte
Nullstelle, es gibt dann nur einzige verallgemeinerte Potenzreihe
$J_0(x)$ als L"osung.
Nach der Motivation in Abschnitt~\ref{potenzreihen:doppeltens} erwarten
wir eine weitere L"osung mit einem $\log(x)$-Term.
Wir konstruieren daher den neuen Ansatz
\begin{equation}
y(x)
=
\beta J_0(x)\log(x)+\beta_0+\beta_1x+\beta_2x^2+\beta_3x^3+\dots
\label{potenzreihen:k0ansatz}
\end{equation}
Davon brauchen wir die Ableitungen, 
\begin{align*}
y'(x)
&=
\beta J_0'(x)\log(x) + \beta J_0(x)\frac1x+\beta_1+2\beta_2x+3\beta_3x^2+\dots
\\
y''(x)
&=
\beta J_0''(x)\log(x) + 2\beta J_0'(x)\frac1x-\beta J_0(x)\frac1{x^2} + 2\beta_2 + 3\cdot 2\beta_3 x + 4\cdot 3\beta_4 x^2+\dots
\end{align*}
Die Nenner machen uns keine Sorgen, denn in der Differentialgleichung werden
die Funktionen mit Potenzen von $x$ multipliziert, die die Nenner zum
Verschwinden bringen werden.
Die Schwierigkeit ist eher, den Logarithmus-Term zum Verschwinden zu bringen.
Wir setzen die Funktionen daher in die Differentialgleichung ein:
\begin{align*}
0
&=
x^2y''(x)+xy'(x)+x^2y(x)
\\
&=
\beta x^2J_0''(x)\log(x) + 2x\beta J_0'(x)-\beta J_0(x) + 2\beta_2x^2 + 3\cdot 2\beta_3 x^3 + 4\cdot 3\beta_4 x^4+\dots
\\
&\phantom{=}+
\beta xJ_0'(x)\log(x) + \beta J_0(x)+\beta_1x+2\beta_2x^2+3\beta_3x^4+\dots
\\
&\phantom{=}+
\beta x^2J_0(x)\log(x)+\beta_0x^2+\beta_1x^3 +\beta_2x^4+\beta_3x^5+\dots
\\
&=
\beta(x^2J_0''(x)+xJ_0'(x)+x^2J_0(x))\log(x)
+
\text{Potenzreihe in $x$}
\end{align*}
Der Klammerausdruck in der letzten Zeile ist gerade die Besselsche
Differentialgleichung, und da $J_0(x)$ eine L"osung derselben ist,
verschwindet er.
Damit ist gezeigt, dass die Logarithmus-Terme herausfallen, und mit dem
"ublichen Verfahren des Koeffizientenvergleichs die Koeffizienten
$\beta_k$ einer L"osung bestimmt werden k"onnen.

Setzt man zudem $\beta=1$, kann man die L"osung explizit ermitteln, die
etwas langeweilige Rechnung ergibt
\begin{align*}
K_0(x)
&=
J_0(x)\log(x)
+
\frac{x^2}{2^2}
-
\frac{x^4}{2^2\cdot 4^2}\biggl(1+\frac12\biggr)
+
\frac{x^6}{2^2\cdot 4^2\cdot 6^2}\biggl(1+\frac12+\frac13\biggr)
\\
&\qquad
-
\frac{x^8}{2^2\cdot 4^2\cdot 6^2\cdot 8^2}\biggl(1+\frac12+\frac13+\frac14\biggr)
+
\dots
\label{potenzreihen:k0}
\\
&=
J_0(x)\log(x)
-\sum_{l=1}^\infty (-1)^k\frac{x^{2k}}{(k!\cdot 2^k)^2}\sum_{i=1}^k\frac1s
\end{align*}
Dies ist die Bessel-Funktion 0-ter Ordnung und {\em zweiter Art} (siehe auch
\index{Bessselfunktion zweiter Art}
\cite{skript:smirnow2}).

\section{"Ubungsaufgaben}
\rhead{"Ubungsaufgaben}
\begin{uebungsaufgaben}
\item
\input uebungsaufgaben/401.tex
\item
\input uebungsaufgaben/402.tex
\end{uebungsaufgaben}




